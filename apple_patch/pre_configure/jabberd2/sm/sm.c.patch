--- /tmp/jabberd-2.1.24.1/sm/sm.c	2008-04-27 02:57:18.000000000 -0700
+++ ./jabberd2/sm/sm.c	2008-12-03 22:10:32.000000000 -0800
@@ -153,7 +153,7 @@ int sm_sx_callback(sx_t s, sx_event_t e,
                     if (ns >= 0) {
                         elem = nad_find_elem(nad, 0, ns, "starttls", 1);
                         if (elem >= 0) {
-                            if (sx_ssl_client_starttls(sm->sx_ssl, s, NULL) == 0) {
+                            if (sx_ssl_client_starttls(sm->sx_ssl, s, NULL, NULL) == 0) {
                                 nad_free(nad);
                                 return 0;
                             }
